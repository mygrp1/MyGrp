<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MyGrp</title>
  <meta name="description" content="A Page to Find Your Classes and Schedule in USTHB">
  <link rel="icon" href="Logo/Grp.JPG" type="image/jpg">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
  
  <style>
    /* === General Reset === */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* === General Body Layout === */
    body {
      font-family: 'Open Sans', Arial, sans-serif;
      background: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      padding: 20px;
      color: #222;
      line-height: 1.6;
    }

    /* === Container for better mobile layout === */
    .container {
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
    }

    /* === Custom Modal Styles === */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(4px);
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      max-width: 400px;
      width: 90%;
      text-align: center;
      border: 3px solid #ffc420;
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .modal-icon {
      font-size: 48px;
      margin-bottom: 15px;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
    }

    .modal-message {
      font-size: 1.1rem;
      margin-bottom: 25px;
      color: #666;
      line-height: 1.5;
    }

    .modal-student-info {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 4px solid #ffc420;
    }

    .modal-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .modal-button {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 100px;
    }

    .modal-button.confirm {
      background: #ff4444;
      color: white;
    }

    .modal-button.confirm:hover {
      background: #cc0000;
      transform: translateY(-2px);
    }

    .modal-button.cancel {
      background: #6c757d;
      color: white;
    }

    .modal-button.cancel:hover {
      background: #545b62;
      transform: translateY(-2px);
    }

    /* === Search Section === */
    .search-section {
      text-align: center;
      margin-top: 20px;
      width: 100%;
    }

    /* === Inputs - Responsive === */
    input[type="text"] {
      width: 100%;
      max-width: 400px;
      padding: 12px 15px;
      margin: 8px 0;
      border: 1px solid #dfe1e5;
      border-radius: 24px;
      font-size: 16px;
      outline: none;
      transition: border-color 0.2s ease;
    }

    input:focus {
      border-color: #ffc420;
      box-shadow: 0 0 4px rgba(255, 196, 32, 0.5);
    }

    /* === Teacher Group Input === */
    .teacher-inputs {
      display: flex;
      gap: 10px;
      justify-content: center;
      align-items: center;
      margin: 15px 0;
      flex-wrap: wrap;
    }

    .teacher-inputs input {
      max-width: 200px;
    }

    /* === Buttons - Responsive === */
    button {
      width: 100%;
      max-width: 200px;
      margin: 10px 0;
      padding: 12px 20px;
      background: #ffc420;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s ease, transform 0.1s ease;
      font-weight: bold;
      font-size: 16px;
    }

    button:hover {
      background: #f4a300;
      transform: translateY(-1px);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .save-button {
      background: #4CAF50;
      color: white;
      margin-top: 20px;
    }

    .save-button:hover {
      background: #45a049;
    }

    .delete-button {
      background: #ff4444;
      color: white;
      padding: 6px 12px;
      font-size: 12px;
      max-width: 80px;
      margin: 0;
    }

    .delete-button:hover {
      background: #cc0000;
    }

    /* === Search Result === */
    #result {
      margin-top: 20px;
      width: 100%;
      max-width: 1100px;
      text-align: left;
    }

    .result-line {
      opacity: 0;
      transform: translateY(15px);
      animation: slideUp 0.5s ease-out forwards;
      margin: 10px 0;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #ffc420;
      word-wrap: break-word;
    }

    /* Special styling for teacher mode results */
    .teacher-result {
      border-left-color: #4CAF50;
      background: #f1f8e9;
    }

    /* Teacher list styling */
    .teacher-list {
      margin-top: 20px;
      width: 100%;
      border-collapse: collapse;
    }

    .teacher-list th {
      background-color: #4CAF50;
      color: white;
      padding: 12px 15px;
      text-align: left;
    }

    .teacher-list td {
      padding: 10px 15px;
      border-bottom: 1px solid #ddd;
    }

    .teacher-list tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .teacher-list tr:hover {
      background-color: #f1f1f1;
    }

    /* Attendance checkbox styling */
    .attendance-checkbox {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .attendance-checkbox:checked {
      accent-color: #4CAF50;
    }

    /* Group input in table */
    .group-input {
      width: 80px;
      padding: 5px;
      border: 1px solid #ddd;
      border-radius: 4px;
      text-align: center;
    }

    /* Note styling */
    .note-text {
      font-size: 12px;
      color: #666;
      font-style: italic;
      margin-top: 5px;
    }

    .remove-note {
      color: #ff4444;
      cursor: pointer;
      margin-left: 5px;
      font-weight: bold;
    }

    @keyframes slideUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* === Section Headings === */
    h2 {
      margin: 30px 0 20px 0;
      color: #333;
      font-size: 1.5rem;
      text-align: center;
    }

    /* === Admin Checkbox === */
    .admin-container {
      margin-top: 20px;
      text-align: center;
    }

    #adminCheck {
      margin: 10px;
      accent-color: green;
      transform: scale(1.2);
    }

    /* === Teacher Mode Indicator === */
    .teacher-mode {
      background-color: #e8f5e9;
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
      text-align: center;
      border: 1px solid #4CAF50;
    }

    /* === Responsive Design for Mobile === */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .container {
        padding: 10px;
      }
      
      h2 {
        font-size: 1.3rem;
        margin: 20px 0 15px 0;
      }
      
      input[type="text"] {
        font-size: 16px;
        padding: 14px 15px;
      }
      
      button {
        padding: 14px 20px;
        font-size: 16px;
      }
      
      .result-line {
        padding: 10px;
        font-size: 14px;
        margin: 8px 0;
      }
      
      .teacher-list {
        font-size: 14px;
      }
      
      .teacher-list th, .teacher-list td {
        padding: 8px 10px;
      }
      
      .teacher-inputs {
        flex-direction: column;
      }
      
      .teacher-inputs input {
        max-width: 100%;
      }
      
      .delete-button {
        padding: 4px 8px;
        font-size: 11px;
        max-width: 60px;
      }

      .modal-content {
        padding: 20px;
      }

      .modal-buttons {
        flex-direction: column;
        gap: 10px;
      }

      .modal-button {
        width: 100%;
      }
    }

    @media (max-width: 480px) {
      h2 {
        font-size: 1.2rem;
      }
      
      input[type="text"] {
        border-radius: 20px;
      }
      
      button {
        border-radius: 6px;
      }
      
      .search-section {
        margin-top: 10px;
      }
      
      .teacher-list {
        font-size: 12px;
      }
      
      .group-input {
        width: 60px;
      }
      
      .delete-button {
        padding: 3px 6px;
        font-size: 10px;
        max-width: 50px;
      }

      .modal-content {
        padding: 15px;
      }

      .modal-title {
        font-size: 1.3rem;
      }

      .modal-message {
        font-size: 1rem;
      }
    }

    @media (max-width: 320px) {
      body {
        padding: 5px;
      }
      
      .container {
        padding: 5px;
      }
      
      h2 {
        font-size: 1.1rem;
      }
    }

    @media (hover: none) {
      button:hover {
        transform: none;
        background: #ffc420;
      }
      
      button:active {
        background: #f4a300;
        transform: scale(0.98);
      }
      
      .delete-button:active {
        background: #cc0000;
      }

      .modal-button:hover {
        transform: none;
      }

      .modal-button:active {
        transform: scale(0.98);
      }
    }
  </style>
</head>
<body>
  <!-- Custom Delete Confirmation Modal -->
  <div id="deleteModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-icon">‚ö†Ô∏è</div>
      <div class="modal-title">Delete Student</div>
      <div class="modal-message">Are you sure you want to remove this student from the table?</div>
      <div id="modalStudentInfo" class="modal-student-info">
        <!-- Student info will be inserted here -->
      </div>
      <div class="modal-buttons">
        <button id="confirmDelete" class="modal-button confirm">Yes, Delete</button>
        <button id="cancelDelete" class="modal-button cancel">Cancel</button>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- üîç Search Section -->
    <div class="search-section">
      <h2>üîç Find Your Class Info</h2>
      <input type="text" id="searchInput" placeholder="Enter your matricule number">
      <button id="searchButton">Search</button>
      
      <!-- Teacher Inputs (Hidden by default) -->
      <div id="teacherInputs" class="teacher-inputs" style="display: none;">
        <input type="text" id="groupInput" placeholder="Enter group number">
        <button id="addStudentButton">Add Student</button>
        <button id="saveButton" class="save-button">üíæ Save Table</button>
      </div>
      
      <div id="result"></div>
      <!-- Teacher list will be displayed here -->
      <div id="teacherListContainer"></div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Complete student data array
      const data = [
                    { MAT: "252531643819", NAME: "ABBES", PNAME: "ABDEL MOUMENE", SECT: "13", GRP_TP: "B" },
    { MAT: "252531471101", NAME: "ABDELAZIZ", PNAME: "YOUCEF ISLEM", SECT: "13", GRP_TP: "C" },
    { MAT: "242431724503", NAME: "ABDELBAKI", PNAME: "Houssem abdelileh", SECT: "13", GRP_TP: "E" },
    { MAT: "252531724113", NAME: "ABDELHAFID", PNAME: "BADEREDDINE", SECT: "13", GRP_TP: "A" },
    { MAT: "222231311815", NAME: "ABDESSELAM", PNAME: "MOHAMED TAHAR ABDENASSEI", SECT: "13", GRP_TP: "D" },
    { MAT: "242431694710", NAME: "ABID", PNAME: "ILHEM", SECT: "13", GRP_TP: "E" },
    { MAT: "252531772105", NAME: "ABROUS", PNAME: "MARIA", SECT: "13", GRP_TP: "F" },
    { MAT: "252531806220", NAME: "AHMANI", PNAME: "RIAD", SECT: "13", GRP_TP: "D" },
    { MAT: "242431614504", NAME: "AICHEKADRA", PNAME: "BILLAL", SECT: "13", GRP_TP: "A" },
    { MAT: "252531619811", NAME: "AISSANI", PNAME: "IDRIS ANES ZAKARIA", SECT: "13", GRP_TP: "F" },
    { MAT: "232331090313", NAME: "AIT BELKACEM", PNAME: "ROMAISSA", SECT: "13", GRP_TP: "E" },
    { MAT: "242431403914", NAME: "AITECHE", PNAME: "MOHAMED", SECT: "13", GRP_TP: "B" },
    { MAT: "252531785609", NAME: "AKNINE", PNAME: "DORIA", SECT: "13", GRP_TP: "B" },
    { MAT: "242431723505", NAME: "ALJOUNAIDY", PNAME: "MAHMOUD", SECT: "13", GRP_TP: "F" },
    { MAT: "252531796405", NAME: "ALLAD", PNAME: "OUSSAMA", SECT: "13", GRP_TP: "D" },
    { MAT: "252531697915", NAME: "AMEUR", PNAME: "MADINA", SECT: "13", GRP_TP: "C" },
    { MAT: "252531637219", NAME: "AMOKRANE", PNAME: "MARIA", SECT: "13", GRP_TP: "D" },
    { MAT: "252531716119", NAME: "AMROUCH", PNAME: "MOHAMED IHEB", SECT: "13", GRP_TP: "E" },
    { MAT: "252531399707", NAME: "AMROUCHE", PNAME: "MOHAMED WASSIM", SECT: "13", GRP_TP: "F" },
    { MAT: "252531702502", NAME: "AMROUCHE", PNAME: "NAZYM", SECT: "13", GRP_TP: "D" },
    { MAT: "252531506703", NAME: "AOUAS", PNAME: "AMIR MOHAMED AKLI", SECT: "13", GRP_TP: "E" },
    { MAT: "252531687805", NAME: "AROUCHE", PNAME: "MOHAMED", SECT: "13", GRP_TP: "A" },
    { MAT: "242431664705", NAME: "ATROUZ", PNAME: "RYM SERINE", SECT: "13", GRP_TP: "E" },
    { MAT: "252531785418", NAME: "BACHA", PNAME: "BESMALA", SECT: "13", GRP_TP: "B" },
    { MAT: "242431359320", NAME: "BADAQUI", PNAME: "AYA", SECT: "13", GRP_TP: "C" },
    { MAT: "242531672816", NAME: "BAGHDADI", PNAME: "NERDIES", SECT: "13", GRP_TP: "F" },
    { MAT: "232331424920", NAME: "BAOUCHE", PNAME: "MOHAMED ABDERRAOUF", SECT: "13", GRP_TP: "D" },
    { MAT: "252531734916", NAME: "BAZIZ", PNAME: "NADA", SECT: "13", GRP_TP: "A" },
    { MAT: "242531672201", NAME: "BEB", PNAME: "MESSAOUD", SECT: "13", GRP_TP: "E" },
    { MAT: "222231648020", NAME: "BELALIAT", PNAME: "ABDERRAHMANE SIDALI", SECT: "13", GRP_TP: "F" },
    { MAT: "242431741920", NAME: "BELGUENBOUR", PNAME: "YOUNES", SECT: "13", GRP_TP: "D" },
    { MAT: "242431448309", NAME: "BELHOCINE", PNAME: "ABDERRAHMANE", SECT: "13", GRP_TP: "B" },
    { MAT: "242431802303", NAME: "BELHOCINE", PNAME: "WALID", SECT: "13", GRP_TP: "C" },
    { MAT: "252531699218", NAME: "BELKADI", PNAME: "YASMINE", SECT: "13", GRP_TP: "E" },
    { MAT: "242431369820", NAME: "BELKAHLA", PNAME: "YOUCEF ABDELDIALIL", SECT: "13", GRP_TP: "A" },
    { MAT: "252531492312", NAME: "BELKEBLA", PNAME: "ISSAM", SECT: "13", GRP_TP: "F" },
    { MAT: "242531568218", NAME: "BEN AGOUNE", PNAME: "ABIR", SECT: "13", GRP_TP: "C" },
    { MAT: "252531723909", NAME: "BENAZIB", PNAME: "IMENE", SECT: "13", GRP_TP: "A" },
    { MAT: "242431616201", NAME: "BENBESSI", PNAME: "SABER", SECT: "13", GRP_TP: "F" },
    { MAT: "252531612201", NAME: "BENCHEAAH", PNAME: "IMANE", SECT: "13", GRP_TP: "B" },
    { MAT: "252531794904", NAME: "BENCHEIKH", PNAME: "ABDELMALEK", SECT: "13", GRP_TP: "C" },
    { MAT: "252531439603", NAME: "BENGUEDDOUDI", PNAME: "AYA", SECT: "13", GRP_TP: "D" },
    { MAT: "252531506404", NAME: "BENHALLA", PNAME: "AMINE", SECT: "13", GRP_TP: "A" },
    { MAT: "242431565214", NAME: "BENKHELIFA", PNAME: "ABIR DAOUSSANE", SECT: "13", GRP_TP: "B" },
    { MAT: "242431786808", NAME: "BENMERADI", PNAME: "SELSABIL", SECT: "13", GRP_TP: "D" },
    { MAT: "252531595320", NAME: "BENOUMECHIARA", PNAME: "RAFIK ABDELHAMID", SECT: "13", GRP_TP: "B" },
    { MAT: "252531613720", NAME: "BENSAAD", PNAME: "CHEMS EDDINE", SECT: "13", GRP_TP: "E" },
    { MAT: "252533207311", NAME: "BENSENOUCI", PNAME: "ABD NACER", SECT: "13", GRP_TP: "C" },
    { MAT: "242431367916", NAME: "BENTALBI", PNAME: "AYMEN", SECT: "13", GRP_TP: "F" },
    { MAT: "242531885512", NAME: "BENYOUNES", PNAME: "ACHERAF", SECT: "13", GRP_TP: "A" },
  { MAT: "252531480703", NAME: "BENZAOUI", PNAME: "IMAD", SECT: "13", GRP_TP: "C" },
  { MAT: "242431564120", NAME: "BENZID", PNAME: "YOUNES", SECT: "13", GRP_TP: "A" },
  { MAT: "242431677806", NAME: "BENZIOUCHE", PNAME: "MOHAMED MAHDI", SECT: "13", GRP_TP: "B" },
  { MAT: "252531436201", NAME: "BERKANE", PNAME: "ADEM", SECT: "13", GRP_TP: "B" },
  { MAT: "242531890412", NAME: "BERKATI", PNAME: "ASMA", SECT: "13", GRP_TP: "C" },
  { MAT: "252531491807", NAME: "BESSAAD", PNAME: "SAMI", SECT: "13", GRP_TP: "C" },
  { MAT: "252531785413", NAME: "BIBI", PNAME: "IMANE", SECT: "13", GRP_TP: "D" },
  { MAT: "242431775505", NAME: "BOUAQUINA", PNAME: "HAROUNE", SECT: "13", GRP_TP: "A" },
  { MAT: "232331344210", NAME: "BOUBETRA", PNAME: "AYA", SECT: "13", GRP_TP: "E" },
  { MAT: "242431460713", NAME: "BOUBGAR", PNAME: "MOHAMED", SECT: "13", GRP_TP: "F" },
  { MAT: "242431403213", NAME: "BOUCHABOU", PNAME: "KHADDIA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531440417", NAME: "BOUCHAMA", PNAME: "ABDELDJALIL", SECT: "13", GRP_TP: "A" },
  { MAT: "252531439215", NAME: "BOUCHENDOUKA", PNAME: "YASSER", SECT: "13", GRP_TP: "D" },
  { MAT: "252531480810", NAME: "BOUDELLAL", PNAME: "MOHAMED SOHEIB", SECT: "13", GRP_TP: "E" },
  { MAT: "232331378207", NAME: "BOUDIAF", PNAME: "OUALID", SECT: "13", GRP_TP: "F" },
  { MAT: "252531809405", NAME: "BOUDISSA", PNAME: "ZAKARIA", SECT: "13", GRP_TP: "C" },
  { MAT: "252531496001", NAME: "BOUGAL", PNAME: "MOUHAMED", SECT: "13", GRP_TP: "E" },
  { MAT: "252531763408", NAME: "BOUGUEDOURA", PNAME: "ABDEREZAK", SECT: "13", GRP_TP: "B" },
  { MAT: "252531381417", NAME: "BOUGUERRA", PNAME: "SABER ABDELDJALIL", SECT: "13", GRP_TP: "F" },
  { MAT: "252531686110", NAME: "BOUGUETTAYA", PNAME: "NASMA EL ZAHRA", SECT: "13", GRP_TP: "A" },
  { MAT: "222231473711", NAME: "BOUHAMADI", PNAME: "MERIEM CERINE", SECT: "13", GRP_TP: "D" },
  { MAT: "252531709214", NAME: "BOUKERSI", PNAME: "HIBA IMENE", SECT: "13", GRP_TP: "D" },
  { MAT: "252531640611", NAME: "BOUKHARI", PNAME: "ABDERAOUF", SECT: "13", GRP_TP: "C" },
  { MAT: "232431649906", NAME: "BOUKHERIS", PNAME: "ACHIK EDDINE", SECT: "13", GRP_TP: "A" },
  { MAT: "232331547420", NAME: "BOULAHIA", PNAME: "LOKMENE", SECT: "13", GRP_TP: "B" },
  { MAT: "242431756701", NAME: "BOULAHLIB", PNAME: "YAHIA", SECT: "13", GRP_TP: "C" },
  { MAT: "212431525817", NAME: "BOUMAOUGAFI", PNAME: "IDRISS", SECT: "13", GRP_TP: "B" },
  { MAT: "252531472118", NAME: "BOUMCHEDA", PNAME: "MOHAMED", SECT: "13", GRP_TP: "E" },
  { MAT: "252531381119", NAME: "BOUNAB", PNAME: "Rawal", SECT: "13", GRP_TP: "A" },
  { MAT: "252531406515", NAME: "BOURAS", PNAME: "LINA", SECT: "13", GRP_TP: "B" },
  { MAT: "232331771109", NAME: "BOURBIA", PNAME: "RIM", SECT: "13", GRP_TP: "F" },
  { MAT: "222231659210", NAME: "BOUTELDJA", PNAME: "NARIMANE", SECT: "13", GRP_TP: "E" },
  { MAT: "252531611520", NAME: "BRADAIA", PNAME: "ANIS", SECT: "13", GRP_TP: "C" },
  { MAT: "252531702211", NAME: "BRAHIMI", PNAME: "YACINE", SECT: "13", GRP_TP: "D" },
  { MAT: "252531815008", NAME: "BRAHIMI", PNAME: "MERIEM", SECT: "13", GRP_TP: "E" },
  { MAT: "252531885502", NAME: "CHANANE", PNAME: "OUSSAMA", SECT: "13", GRP_TP: "F" },
  { MAT: "242431432402", NAME: "CHAQUAD", PNAME: "MAHDI", SECT: "13", GRP_TP: "C" },
  { MAT: "252531506205", NAME: "CHAREF", PNAME: "NOUR EL ISLAM", SECT: "13", GRP_TP: "F" },
  { MAT: "222231472204", NAME: "CHEHRIT", PNAME: "RACIM", SECT: "13", GRP_TP: "D" },
  { MAT: "252531413102", NAME: "CHERATTIA", PNAME: "ABDERRAOUF", SECT: "13", GRP_TP: "D" },
  { MAT: "252531785908", NAME: "CHERF", PNAME: "SARAH", SECT: "13", GRP_TP: "E" },
  { MAT: "252531480818", NAME: "CHERRAD", PNAME: "MERIEM", SECT: "13", GRP_TP: "F" },
  { MAT: "252531698203", NAME: "CHIKH", PNAME: "MASSINISSA", SECT: "13", GRP_TP: "A" },
  { MAT: "242431425002", NAME: "CHIKHI", PNAME: "FAYCAL", SECT: "13", GRP_TP: "E" },
  { MAT: "242431412401", NAME: "DAHMANI", PNAME: "ABDELMOUNAIM", SECT: "13", GRP_TP: "F" },
  { MAT: "252531380719", NAME: "DAOUD", PNAME: "IKRAM", SECT: "13", GRP_TP: "B" },
  { MAT: "232431838402", NAME: "DENAIB", PNAME: "ACHREF", SECT: "13", GRP_TP: "C" },
  { MAT: "212431544502", NAME: "DEROUAZ", PNAME: "AMAR", SECT: "13", GRP_TP: "D" },
  { MAT: "232331634602", NAME: "DIAB", PNAME: "IKRAM", SECT: "13", GRP_TP: "A" },
  { MAT: "252531707804", NAME: "DIB", PNAME: "SAIDA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531707410", NAME: "DIARBOUA", PNAME: "DOUAA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531822415", NAME: "DIEHA", PNAME: "HIDAYETTE NABILA", SECT: "13", GRP_TP: "A" },
  { MAT: "252531470501", NAME: "DIEMMANE", PNAME: "FERIEL", SECT: "13", GRP_TP: "E" },
  { MAT: "252531635401", NAME: "DRAHMOUNE", PNAME: "SARA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531430315", NAME: "DRIDER", PNAME: "ABDELKRIM", SECT: "13", GRP_TP: "E" },
  { MAT: "232331403002", NAME: "DRIS", PNAME: "ANYA", SECT: "13", GRP_TP: "F" },
  { MAT: "222431854819", NAME: "DRIS", PNAME: "NESRINE", SECT: "13", GRP_TP: "F" },
  { MAT: "252531638019", NAME: "DZIRIL", PNAME: "MERIEM", SECT: "13", GRP_TP: "C" },
  { MAT: "242431789010", NAME: "FEDGHOUCHE", PNAME: "HADJER", SECT: "13", GRP_TP: "A" },
  { MAT: "252531813911", NAME: "FELLAH", PNAME: "ASMA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531746409", NAME: "FERHAT", PNAME: "RAHMA DOUAA", SECT: "13", GRP_TP: "B" },
  { MAT: "242431712009", NAME: "FERRAG", PNAME: "AYMEN", SECT: "13", GRP_TP: "C" },
  { MAT: "232331705506", NAME: "FERRIA", PNAME: "LOUKMANE ABDELBASSET", SECT: "13", GRP_TP: "C" },
  { MAT: "252531635620", NAME: "FETHANI", PNAME: "SKANDER", SECT: "13", GRP_TP: "A" },
  { MAT: "252531711002", NAME: "FETMOUCHE", PNAME: "DOUAA NADA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531437003", NAME: "FODIL", PNAME: "HAMZA ZAKARIA", SECT: "13", GRP_TP: "A" },
  { MAT: "252531598020", NAME: "GHEZALI", PNAME: "YOUSRA", SECT: "13", GRP_TP: "C" },
  { MAT: "242531871808", NAME: "GHODBANE", PNAME: "SIRADJ EDDINE", SECT: "13", GRP_TP: "E" },
  { MAT: "252531382414", NAME: "GOUBI", PNAME: "WISSAL", SECT: "13", GRP_TP: "B" },
  { MAT: "242431368517", NAME: "GUENDOUZI", PNAME: "SERINE", SECT: "13", GRP_TP: "D" },
  { MAT: "252531481715", NAME: "GUERMAN", PNAME: "MALAK", SECT: "13", GRP_TP: "E" },
  { MAT: "232331623713", NAME: "GUERROUMI", PNAME: "ZINEDDINE", SECT: "13", GRP_TP: "A" },
  { MAT: "252531449917", NAME: "GUERROUT", PNAME: "MOHAMED WASSIM", SECT: "13", GRP_TP: "F" },
  { MAT: "222231472107", NAME: "GUETTOUCHE", PNAME: "AHMED YACINE", SECT: "13", GRP_TP: "C" },
  { MAT: "242431595406", NAME: "GUIDOUM", PNAME: "MOHAMED CHAKIB", SECT: "13", GRP_TP: "A" },
  { MAT: "232331370214", NAME: "HADDAD", PNAME: "ROZA", SECT: "13", GRP_TP: "F" },
  { MAT: "252531427417", NAME: "HADJ ZEKRI", PNAME: "HAYET", SECT: "13", GRP_TP: "D" },
  { MAT: "242431461802", NAME: "HADJI", PNAME: "BILAL", SECT: "13", GRP_TP: "B" },
  { MAT: "242431705609", NAME: "HAFFAD", PNAME: "HADIL", SECT: "13", GRP_TP: "D" },
  { MAT: "242531568502", NAME: "HAMDINI", PNAME: "KENZA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531437912", NAME: "HAMECH", PNAME: "ABDELAZIZ SAMI", SECT: "13", GRP_TP: "C" },
  { MAT: "242431695504", NAME: "HAMMADE", PNAME: "LINA", SECT: "13", GRP_TP: "E" },
  { MAT: "252531555004", NAME: "HAMMOUALI", PNAME: "ABDELHAFID", SECT: "13", GRP_TP: "F" },
  { MAT: "242431747719", NAME: "HANNACHI", PNAME: "HANAFI", SECT: "13", GRP_TP: "A" },
  { MAT: "252531752903", NAME: "HAOUA", PNAME: "NOUR EL MALEK", SECT: "13", GRP_TP: "C" },
  { MAT: "242431441404", NAME: "HASSANI", PNAME: "ADEM", SECT: "13", GRP_TP: "A" },
  { MAT: "252531587720", NAME: "HATEM", PNAME: "YACINE", SECT: "13", GRP_TP: "B" },
  { MAT: "242531547707", NAME: "HERAOUA", PNAME: "AVOUB ABDERRAOUF", SECT: "13", GRP_TP: "D" },
  { MAT: "252531503003", NAME: "HIRED", PNAME: "DJAAFAR", SECT: "13", GRP_TP: "E" },
  { MAT: "242431484903", NAME: "HOUAS", PNAME: "ABDELMOUMEN", SECT: "13", GRP_TP: "F" },
  { MAT: "242435467514", NAME: "IDIR", PNAME: "GHELAD", SECT: "13", GRP_TP: "B" },
  { MAT: "252531213716", NAME: "IKHLEF", PNAME: "SERINE RANIA", SECT: "13", GRP_TP: "C" },
  { MAT: "242431743205", NAME: "KAHLOUCHE", PNAME: "MERIEM", SECT: "13", GRP_TP: "E" },
  { MAT: "232331632407", NAME: "KASBADJI", PNAME: "MOHAMED SALIM", SECT: "13", GRP_TP: "C" },
  { MAT: "222231663910", NAME: "KDIB", PNAME: "HAROUN", SECT: "13", GRP_TP: "F" },
  { MAT: "232331336314", NAME: "KELKOULI", PNAME: "KHADIDJA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531618712", NAME: "KHELLOUF", PNAME: "MOHAMED", SECT: "13", GRP_TP: "A" },
  { MAT: "252531598918", NAME: "KHENDEK", PNAME: "MOHAMED KENZI", SECT: "13", GRP_TP: "E" },
  { MAT: "232332308311", NAME: "KHOUAS", PNAME: "RAOUF", SECT: "13", GRP_TP: "D" },
  { MAT: "242531888419", NAME: "KIARED", PNAME: "YASMINE", SECT: "13", GRP_TP: "F" },
  { MAT: "252531506403", NAME: "KIRECHE", PNAME: "AMINE", SECT: "13", GRP_TP: "D" },
  { MAT: "252531643701", NAME: "KOUADRAI", PNAME: "HAMZA", SECT: "13", GRP_TP: "E" },
    { MAT: "242431422305", NAME: "LABED", PNAME: "LINA", SECT: "13", GRP_TP: "E" },
  { MAT: "232331685411", NAME: "LACHIBI", PNAME: "RAID ADDINE", SECT: "13", GRP_TP: "A" },
  { MAT: "242431750016", NAME: "LAGAB", PNAME: "SERINE", SECT: "13", GRP_TP: "F" },
  { MAT: "252531441108", NAME: "LAMARA", PNAME: "ABDELALI", SECT: "13", GRP_TP: "F" },
  { MAT: "242431790508", NAME: "LARAS", PNAME: "AVOUB", SECT: "13", GRP_TP: "B" },
  { MAT: "232335534102", NAME: "LARBI", PNAME: "Fares", SECT: "13", GRP_TP: "C" },
  { MAT: "242431474707", NAME: "LARBI DIDOUCHE", PNAME: "HADIA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531794003", NAME: "LARROUSSI", PNAME: "AYA NIDHAL", SECT: "13", GRP_TP: "D" },
  { MAT: "242531559412", NAME: "LASMI", PNAME: "MOHAMED EL ARBI", SECT: "13", GRP_TP: "E" },
  { MAT: "252531478617", NAME: "LASSAKEUR", PNAME: "AICHA CHAIMA", SECT: "13", GRP_TP: "A" },
  { MAT: "252531599715", NAME: "LAZIZI", PNAME: "NAILA", SECT: "13", GRP_TP: "C" },
  { MAT: "252531778606", NAME: "LAZREG", PNAME: "SYRINE", SECT: "13", GRP_TP: "B" },
  { MAT: "242431412514", NAME: "LEECHIRI", PNAME: "FERIEL", SECT: "13", GRP_TP: "A" },
  { MAT: "242531870710", NAME: "LOUADAH", PNAME: "RAYANE", SECT: "13", GRP_TP: "B" },
  { MAT: "242431729009", NAME: "LOUAR", PNAME: "ROFIDA", SECT: "13", GRP_TP: "C" },
  { MAT: "212131072481", NAME: "MADOUCHE", PNAME: "MOHAMED ABDERRAOUF", SECT: "13", GRP_TP: "D" },
  { MAT: "252531726007", NAME: "MAKHLOUFI", PNAME: "MOUHAMED ABDELDIABAR", SECT: "13", GRP_TP: "F" },
  { MAT: "252531441015", NAME: "MALEM", PNAME: "RAFIK ISLEM", SECT: "13", GRP_TP: "A" },
  { MAT: "252531505316", NAME: "MANSOURI", PNAME: "YAHYA AIHAM", SECT: "13", GRP_TP: "D" },
  { MAT: "252531637608", NAME: "MEBAREK", PNAME: "MOHAMED AMINE", SECT: "13", GRP_TP: "E" },
  { MAT: "252531636103", NAME: "MEBARKI", PNAME: "SAFA YASMINE", SECT: "13", GRP_TP: "F" },
  { MAT: "252531701916", NAME: "MEHAMEL", PNAME: "LYNA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531504313", NAME: "MEHENNAQUI", PNAME: "MOHAMED AMINE", SECT: "13", GRP_TP: "B" },
  { MAT: "252531794415", NAME: "MEKHALDI", PNAME: "SARA", SECT: "13", GRP_TP: "C" },
  { MAT: "252531644103", NAME: "MERIOUD", PNAME: "MOKRANE AMINE", SECT: "13", GRP_TP: "A" },
  { MAT: "252531707906", NAME: "MESSACI", PNAME: "CHANEZ", SECT: "13", GRP_TP: "C" },
  { MAT: "232331451603", NAME: "MESSAOUD", PNAME: "BOUSSAD", SECT: "13", GRP_TP: "A" },
  { MAT: "252531504618", NAME: "MESSAOUDI", PNAME: "MERIEM", SECT: "13", GRP_TP: "B" },
  { MAT: "252531120507", NAME: "MESSAOUDI", PNAME: "HAMOU RAMDANE", SECT: "13", GRP_TP: "E" },
  { MAT: "252531805902", NAME: "METENE", PNAME: "KHADIDJA", SECT: "13", GRP_TP: "C" },
  { MAT: "252531615103", NAME: "MEZIANI", PNAME: "LYNA", SECT: "13", GRP_TP: "E" },
  { MAT: "252531373710", NAME: "MIHOUBI", PNAME: "HADIL", SECT: "13", GRP_TP: "F" },
  { MAT: "252531502410", NAME: "MOGHRANI", PNAME: "AMAR", SECT: "13", GRP_TP: "D" },
  { MAT: "252531822307", NAME: "MOKEDEM", PNAME: "FAIROUZ", SECT: "13", GRP_TP: "F" },
  { MAT: "252531438810", NAME: "MOKHTARI", PNAME: "MILYNDA", SECT: "13", GRP_TP: "E" },
  { MAT: "252531491606", NAME: "MOUACI", PNAME: "RAOUNAK", SECT: "13", GRP_TP: "B" },
  { MAT: "252531638120", NAME: "MOUAKI BENANI", PNAME: "MOUAD ABDELKRIM", SECT: "13", GRP_TP: "A" },
  { MAT: "242431625901", NAME: "MOUKEBEL", PNAME: "WALID", SECT: "13", GRP_TP: "F" },
  { MAT: "252531502808", NAME: "MOUSSAOUI", PNAME: "AMINE", SECT: "13", GRP_TP: "B" },
  { MAT: "252531495802", NAME: "MOUZAOUI", PNAME: "SARAH", SECT: "13", GRP_TP: "D" },
  { MAT: "232331419207", NAME: "NAHNAH", PNAME: "MERIEM", SECT: "13", GRP_TP: "C" },
  { MAT: "252531470919", NAME: "NASRI", PNAME: "HIBA", SECT: "13", GRP_TP: "A" },
  { MAT: "252531588008", NAME: "NEKICHE", PNAME: "HAFSA", SECT: "13", GRP_TP: "D" },
  { MAT: "232331708205", NAME: "OUAL", PNAME: "ABDALLAH AVOUB", SECT: "13", GRP_TP: "E" },
  { MAT: "252531788210", NAME: "OUAZZOUG", PNAME: "SOUHA ZINA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531439819", NAME: "OULD AMER", PNAME: "ABDESLAM", SECT: "13", GRP_TP: "F" },
  { MAT: "252531456404", NAME: "OUSSAL", PNAME: "SARAH", SECT: "13", GRP_TP: "C" },
  { MAT: "252531586712", NAME: "OUZZANE", PNAME: "MOHAMED YACINE", SECT: "13", GRP_TP: "C" },
  { MAT: "252531697607", NAME: "RAHMANI", PNAME: "MOHAMED AMINE", SECT: "13", GRP_TP: "A" },
  { MAT: "232331575913", NAME: "REBAI", PNAME: "ABDENOUR", SECT: "13", GRP_TP: "E" },
  { MAT: "252531641608", NAME: "REKAH", PNAME: "INIHAL", SECT: "13", GRP_TP: "D" },
    { MAT: "252531506119", NAME: "REZIG MERHOUNE", PNAME: "MAHDI", SECT: "13", GRP_TP: "E" },
  { MAT: "252531787512", NAME: "RIZOUG ZEGHLACHE", PNAME: "NOUFEL", SECT: "13", GRP_TP: "F" },
  { MAT: "252531741907", NAME: "ROUIKHA", PNAME: "ANYA", SECT: "13", GRP_TP: "F" },
  { MAT: "252531419605", NAME: "SAADAD", PNAME: "AICHA SEROUR", SECT: "13", GRP_TP: "D" },
  { MAT: "252531827214", NAME: "SAADAOUI", PNAME: "ABIR", SECT: "13", GRP_TP: "E" },
  { MAT: "232531563819", NAME: "SABER", PNAME: "HIBA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531707310", NAME: "SAHRAOUI", PNAME: "HOUSSEM", SECT: "13", GRP_TP: "B" },
  { MAT: "232331546403", NAME: "SALHI", PNAME: "SOFIA CHIRAZ AMINA", SECT: "13", GRP_TP: "F" },
  { MAT: "252531457214", NAME: "SAYAH", PNAME: "MALAK", SECT: "13", GRP_TP: "C" },
  { MAT: "232331685210", NAME: "SEDDIKI", PNAME: "MOHAMED ILYES", SECT: "13", GRP_TP: "A" },
  { MAT: "232331442607", NAME: "SELMANE", PNAME: "MARWA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531810220", NAME: "SIDI AISSA", PNAME: "OUMAIMA", SECT: "13", GRP_TP: "E" },
  { MAT: "242431563311", NAME: "SLIMANI", PNAME: "MOUNIA", SECT: "13", GRP_TP: "B" },
  { MAT: "242431485506", NAME: "TAKOUERT", PNAME: "MOHAMED OUSSAMA", SECT: "13", GRP_TP: "C" },
  { MAT: "252531736217", NAME: "TAQUINET", PNAME: "SAFA AMINA", SECT: "13", GRP_TP: "A" },
  { MAT: "252531471911", NAME: "TAYANE", PNAME: "QUALID", SECT: "13", GRP_TP: "E" },
  { MAT: "252531465012", NAME: "TELLACHE", PNAME: "MARIA", SECT: "13", GRP_TP: "F" },
  { MAT: "252531493120", NAME: "TENANI", PNAME: "MERIEM", SECT: "13", GRP_TP: "A" },
  { MAT: "252531697016", NAME: "TILMATINE", PNAME: "CAMILA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531725503", NAME: "TOIAHRIA", PNAME: "FATIMA ZOHRA", SECT: "13", GRP_TP: "D" },
  { MAT: "252531596804", NAME: "TOUBAL", PNAME: "MOHAMED", SECT: "13", GRP_TP: "B" },
  { MAT: "252531766307", NAME: "TOUILEB", PNAME: "SONIA", SECT: "13", GRP_TP: "F" },
  { MAT: "252531888601", NAME: "TOUNSI", PNAME: "YOUNES", SECT: "13", GRP_TP: "C" },
  { MAT: "252531640304", NAME: "TRABELSI", PNAME: "RITEDJ", SECT: "13", GRP_TP: "A" },
  { MAT: "222231602619", NAME: "YAHOUI", PNAME: "MOHAMED ANIS", SECT: "13", GRP_TP: "D" },
  { MAT: "252531439605", NAME: "YAICHE TEMAM", PNAME: "AHMED OBEY", SECT: "13", GRP_TP: "C" },
  { MAT: "252531754417", NAME: "ZAMOUM", PNAME: "Ramzi mohamed ihcene", SECT: "13", GRP_TP: "A" },
  { MAT: "242531877914", NAME: "ZERGOUG", PNAME: "MARIA", SECT: "13", GRP_TP: "B" },
  { MAT: "252531478210", NAME: "ZIANE", PNAME: "ROMAISSA", SECT: "13", GRP_TP: "E" },
        { MAT: "19852005", NAME: "ADMIN", PNAME: "ACCESS", SECT: "13", GRP_TP: "A" } // Add this for testing admin
      ];

      // === Special Teacher Matricules ===
      const teacherMatricules = ["ITCheckListST13G24", "ITCheckListST13G13"];
      let currentTeacherMode = null;
      let teacherStudentList = []; // Store students added by teacher
      let studentToDeleteIndex = null; // Track which student to delete
      
      // === Saved Tables Storage ===
      let savedTables = {
        "ITCheckListST13G24": null,
        "ITCheckListST13G13": null
      };

      // === Modal Elements ===
      const deleteModal = document.getElementById('deleteModal');
      const modalStudentInfo = document.getElementById('modalStudentInfo');
      const confirmDeleteBtn = document.getElementById('confirmDelete');
      const cancelDeleteBtn = document.getElementById('cancelDelete');

      // === Modal Functions ===
      function showDeleteModal(student, index) {
        studentToDeleteIndex = index;
        
        // Format student info for modal
        const { formattedName, formattedPname } = formatNameForTeacher(student.NAME, student.PNAME);
        modalStudentInfo.innerHTML = `
          <strong>${formattedName} ${formattedPname}</strong><br>
          Section: ${student.SECT} | Group: ${student.GRP_TP}<br>
          Matricule: ${student.MAT}
        `;
        
        // Show modal
        deleteModal.classList.add('active');
        
        // Disable background interactions
        document.body.style.overflow = 'hidden';
      }

      function hideDeleteModal() {
        deleteModal.classList.remove('active');
        studentToDeleteIndex = null;
        
        // Re-enable background interactions
        document.body.style.overflow = '';
      }

      // === Modal Event Listeners ===
      confirmDeleteBtn.addEventListener('click', () => {
        if (studentToDeleteIndex !== null) {
          deleteStudent(studentToDeleteIndex);
          hideDeleteModal();
        }
      });

      cancelDeleteBtn.addEventListener('click', hideDeleteModal);

      // Close modal when clicking outside
      deleteModal.addEventListener('click', (e) => {
        if (e.target === deleteModal) {
          hideDeleteModal();
        }
      });

      // === Lab Class and Schedule Function ===
      function getLabInfo(grpTP) {
        let chemistryLab = "";
        let physicsLab = "";
        let week1 = "";
        let week2 = "";

        if (grpTP === "A" || grpTP === "D") {
          chemistryLab = "A204";
          physicsLab = "C104";
        } else if (grpTP === "B" || grpTP === "E") {
          chemistryLab = "A205";
          physicsLab = "C105";
        } else if (grpTP === "C" || grpTP === "F") {
          chemistryLab = "A206";
          physicsLab = "C106";
        }

        if (grpTP === "A" || grpTP === "B" || grpTP === "C") {
          week1 = "Physics Lab";
          week2 = "Chemistry Lab";
        } else {
          week1 = "Chemistry Lab";
          week2 = "Physics Lab";
        }

        return {
          chemistryLab: chemistryLab,
          physicsLab: physicsLab,
          week1: week1,
          week2: week2
        };
      }

      // === Format name for teacher mode ===
      function formatNameForTeacher(name, pname) {
        // Format NAME: All uppercase
        const formattedName = name.toUpperCase();
        
        // Format PNAME: First letter uppercase, rest lowercase
        const formattedPname = pname.charAt(0).toUpperCase() + pname.slice(1).toLowerCase();
        
        return { formattedName, formattedPname };
      }

      // === Check if student belongs to current teacher's groups ===
      function belongsToCurrentTeacherGroups(studentGrpTP) {
        if (currentTeacherMode === "ITCheckListST13G13") {
          // ITCheckListST13G13 handles ONLY Groups A,B,C (Group 1 or 3)
          return ["A", "B", "C"].includes(studentGrpTP);
        } else if (currentTeacherMode === "ITCheckListST13G24") {
          // ITCheckListST13G24 handles ONLY Groups D,E,F (Group 2 or 4)
          return ["D", "E", "F"].includes(studentGrpTP);
        }
        return false;
      }

      // === Get correct teacher for student based on original group ===
      function getCorrectTeacherForStudent(studentGrpTP) {
        // Groups A,B,C belong to ITCheckListST13G13 (Group 1 or 3)
        if (["A", "B", "C"].includes(studentGrpTP)) {
          return "ITCheckListST13G13";
        } 
        // Groups D,E,F belong to ITCheckListST13G24 (Group 2 or 4)
        else if (["D", "E", "F"].includes(studentGrpTP)) {
          return "ITCheckListST13G24";
        }
        return null;
      }

      // === Check if student is in wrong group for current teacher ===
      function isStudentInWrongGroup(studentGrpTP) {
        const correctTeacher = getCorrectTeacherForStudent(studentGrpTP);
        return correctTeacher !== currentTeacherMode;
      }

      // === Delete student from table ===
      function deleteStudent(index) {
        teacherStudentList.splice(index, 1);
        displayTeacherList();
        
        const result = document.getElementById('result');
        result.innerHTML = `<div class="teacher-mode">üóëÔ∏è Student removed from the table</div>`;
      }

      // === Display teacher student list ===
      function displayTeacherList() {
        const container = document.getElementById('teacherListContainer');
        
        if (teacherStudentList.length === 0) {
          container.innerHTML = '';
          return;
        }
        
        let tableHTML = `
          <h2>üìã Student List</h2>
          <table class="teacher-list">
            <thead>
              <tr>
                <th>NAME</th>
                <th>PNAME</th>
                <th>SECTION</th>
                <th>GROUP</th>
                <th>MATRICULE</th>
                <th>ATTENDANCE</th>
                <th>NOTES</th>
                <th>ACTIONS</th>
              </tr>
            </thead>
            <tbody>
        `;
        
        teacherStudentList.forEach((student, index) => {
          const { formattedName, formattedPname } = formatNameForTeacher(student.NAME, student.PNAME);
          const itGroup = student.customGroup || student.GRP_TP;
          const inWrongGroup = isStudentInWrongGroup(student.GRP_TP);
          
          tableHTML += `
            <tr>
              <td>${formattedName}</td>
              <td>${formattedPname}</td>
              <td>${student.SECT}</td>
              <td>
                <input type="text" 
                       class="group-input" 
                       value="${itGroup}" 
                       data-index="${index}"
                       placeholder="Group">
              </td>
              <td>${student.MAT}</td>
              <td>
                <input type="checkbox" 
                       class="attendance-checkbox" 
                       data-index="${index}"
                       ${student.present ? 'checked' : ''}>
              </td>
              <td>
                ${student.note ? `
                  <div class="note-text">
                    ${student.note}
                    <span class="remove-note" data-index="${index}">‚úï</span>
                  </div>
                ` : ''}
                ${inWrongGroup ? `
                  <div class="note-text" style="color: #ff4444;">
                    From other group
                  </div>
                ` : ''}
              </td>
              <td>
                <button class="delete-button" data-index="${index}">Delete</button>
              </td>
            </tr>
          `;
        });
        
        tableHTML += `
            </tbody>
          </table>
        `;
        
        container.innerHTML = tableHTML;
        
        // Add event listeners
        container.querySelectorAll('.attendance-checkbox').forEach(checkbox => {
          checkbox.addEventListener('change', function() {
            const index = this.getAttribute('data-index');
            teacherStudentList[index].present = this.checked;
          });
        });
        
        container.querySelectorAll('.group-input').forEach(input => {
          input.addEventListener('change', function() {
            const index = this.getAttribute('data-index');
            teacherStudentList[index].customGroup = this.value;
          });
        });
        
        container.querySelectorAll('.remove-note').forEach(button => {
          button.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            teacherStudentList[index].note = '';
            displayTeacherList();
          });
        });
        
        // Add delete button event listeners
        container.querySelectorAll('.delete-button').forEach(button => {
          button.addEventListener('click', function() {
            const index = parseInt(this.getAttribute('data-index'));
            const student = teacherStudentList[index];
            showDeleteModal(student, index);
          });
        });
      }

      // === Save table function ===
      function saveTable() {
        if (!currentTeacherMode) {
          alert("Please activate teacher mode first!");
          return;
        }
        
        // Separate students: correct group vs wrong group
        const correctGroupStudents = [];
        const wrongGroupStudents = [];
        
        teacherStudentList.forEach(student => {
          if (!isStudentInWrongGroup(student.GRP_TP)) {
            // Student belongs to current teacher's groups - save to current table
            correctGroupStudents.push(student);
          } else {
            // Student is from wrong group - add note and save to CORRECT teacher's table
            const wrongGroupStudent = {
              ...student,
              note: `Came with ${currentTeacherMode} groups in last session`
            };
            wrongGroupStudents.push(wrongGroupStudent);
          }
        });
        
        // Save correct group students to current teacher's table
        savedTables[currentTeacherMode] = correctGroupStudents;
        
        // Save wrong group students to their CORRECT teacher's table
        wrongGroupStudents.forEach(student => {
          const correctTeacher = getCorrectTeacherForStudent(student.GRP_TP);
          if (correctTeacher) {
            if (!savedTables[correctTeacher]) {
              savedTables[correctTeacher] = [];
            }
            // Avoid duplicates
            if (!savedTables[correctTeacher].some(s => s.MAT === student.MAT)) {
              savedTables[correctTeacher].push(student);
            }
          }
        });
        
        // Show success message
        const result = document.getElementById('result');
        result.innerHTML = `<div class="teacher-mode">‚úÖ Table saved successfully!</div>`;
        
        if (wrongGroupStudents.length > 0) {
          const correctTeacher = getCorrectTeacherForStudent(wrongGroupStudents[0].GRP_TP);
          result.innerHTML += `<div class="teacher-mode" style="background-color: #fff3cd; border-color: #ffeaa7;">
            ‚ÑπÔ∏è ${wrongGroupStudents.length} student(s) from other groups were saved to ${correctTeacher} table
          </div>`;
        }
        
        // Save to localStorage
        localStorage.setItem('savedTables', JSON.stringify(savedTables));
      }

      // === Load table function ===
      function loadTable(teacherMatricule) {
        const savedData = localStorage.getItem('savedTables');
        if (savedData) {
          savedTables = JSON.parse(savedData);
        }
        
        if (savedTables[teacherMatricule]) {
          teacherStudentList = savedTables[teacherMatricule];
          displayTeacherList();
          
          const result = document.getElementById('result');
          result.innerHTML = `<div class="teacher-mode">üìÇ Loaded saved table with ${teacherStudentList.length} student(s)</div>`;
        }
      }

      // === Search handler ===
      function searchInfo() {
        const mat = document.getElementById('searchInput').value.trim();
        const result = document.getElementById('result');
        result.textContent = "";

        if (!mat) {
          result.textContent = "‚ö†Ô∏è Please enter a matricule number.";
          return;
        }

        // Check if it's a teacher matricule
        if (teacherMatricules.includes(mat)) {
          currentTeacherMode = mat;
          teacherStudentList = []; // Start with empty list
          result.innerHTML = `<div class="teacher-mode">üéì Teacher Mode Activated (${mat})</div>`;
          document.getElementById('searchInput').value = '';
          document.getElementById('searchInput').placeholder = "Enter student matricule";
          document.getElementById('teacherInputs').style.display = 'flex';
          
          // Load saved table if exists
          loadTable(mat);
          return;
        }

        const student = data.find(s => s.MAT === mat);
        if (!student) {
          result.textContent = `‚ùå No student found with matricule "${mat}".`;
          return;
        }

        // === Display results based on mode ===
        if (currentTeacherMode) {
          // Teacher mode - check if student already in list
          const alreadyExists = teacherStudentList.some(s => s.MAT === student.MAT);
          
          if (alreadyExists) {
            result.innerHTML = `<div class="teacher-mode">‚ö†Ô∏è Student with matricule "${mat}" is already in the list!</div>`;
          } else {
            // Show student info and wait for group input
            const { formattedName, formattedPname } = formatNameForTeacher(student.NAME, student.PNAME);
            const inWrongGroup = isStudentInWrongGroup(student.GRP_TP);
            
            result.innerHTML = `
              <div class="teacher-mode">
                ‚úÖ Found: ${formattedName} ${formattedPname} | Section ${student.SECT}<br>
                ${inWrongGroup ? `<span style="color: #ff4444;">‚ö†Ô∏è This student belongs to other groups</span><br>` : ''}
                Enter group number and click "Add Student"
              </div>
            `;
            
            // Store current student for adding
            window.currentStudentToAdd = student;
          }
        } else {
          // Normal student mode display
          displayStudentResults(student);
        }

        checkForAdmin(mat);
      }

      // === Add student with custom group ===
      function addStudentWithGroup() {
        const groupInput = document.getElementById('groupInput').value.trim();
        const result = document.getElementById('result');
        
        if (!window.currentStudentToAdd) {
          result.innerHTML = `<div class="teacher-mode">‚ö†Ô∏è Please search for a student first!</div>`;
          return;
        }
        
        if (!groupInput) {
          result.innerHTML = `<div class="teacher-mode">‚ö†Ô∏è Please enter a group number!</div>`;
          return;
        }
        
        // Add student to list with custom group
        const studentToAdd = {
          ...window.currentStudentToAdd,
          customGroup: groupInput,
          present: false
        };
        
        teacherStudentList.push(studentToAdd);
        displayTeacherList();
        
        const { formattedName, formattedPname } = formatNameForTeacher(studentToAdd.NAME, studentToAdd.PNAME);
        const inWrongGroup = isStudentInWrongGroup(studentToAdd.GRP_TP);
        
        result.innerHTML = `<div class="teacher-mode">
          ‚úÖ Added: ${formattedName} ${formattedPname} | Section ${studentToAdd.SECT} | ${groupInput} | ${studentToAdd.MAT}
          ${inWrongGroup ? `<br><span style="color: #ff4444;">‚ö†Ô∏è This student will be saved to their correct teacher's table</span>` : ''}
        </div>`;
        
        // Clear inputs
        document.getElementById('searchInput').value = '';
        document.getElementById('groupInput').value = '';
        window.currentStudentToAdd = null;
      }

      // === Display results for normal student mode ===
      function displayStudentResults(student) {
        const result = document.getElementById('result');
        const labInfo = getLabInfo(student.GRP_TP);
        const info = `${student.NAME} ${student.PNAME} ‚Äî Section ${student.SECT} ‚Äî Group ${student.GRP_TP}`;
        const lines = info.split('‚Äî').map(s => s.trim());
        
        result.innerHTML = lines.map((line, i) =>
          `<p class="result-line" style="animation-delay:${i * 0.4}s">${line}</p>`).join('');
        
        result.innerHTML += `<p class="result-line" style="animation-delay:${lines.length * 0.4}s">Matricule: ${student.MAT}</p>`;
        result.innerHTML += `<p class="result-line" style="animation-delay:${(lines.length + 1) * 0.4}s">üß™ Chemistry Lab: ${labInfo.chemistryLab}</p>`;
        result.innerHTML += `<p class="result-line" style="animation-delay:${(lines.length + 2) * 0.4}s">‚öõÔ∏è Physics Lab: ${labInfo.physicsLab}</p>`;
        result.innerHTML += `<p class="result-line" style="animation-delay:${(lines.length + 3) * 0.4}s">üìÖ Week 1: ${labInfo.week1} in TP Class</p>`;
        result.innerHTML += `<p class="result-line" style="animation-delay:${(lines.length + 4) * 0.4}s">üìÖ Week 2: ${labInfo.week2} in TP Class</p>`;
      }

      // === Admin Checkbox ===
      let adminCheckboxCreated = false;

      function checkForAdmin(mat) {
        if (mat === "19852005" && !adminCheckboxCreated) {
          const adminContainer = document.createElement('div');
          adminContainer.className = 'admin-container';
          
          const adminCheckbox = document.createElement('input');
          adminCheckbox.type = 'checkbox';
          adminCheckbox.id = 'adminCheck';

          const adminLabel = document.createElement('label');
          adminLabel.htmlFor = 'adminCheck';
          adminLabel.textContent = ' Admin Mode';

          adminContainer.appendChild(adminCheckbox);
          adminContainer.appendChild(adminLabel);
          document.body.appendChild(adminContainer);
          adminCheckboxCreated = true;
          
          document.getElementById('searchInput').value = '';
        }
      }

      // Event listeners
      document.getElementById('searchButton').onclick = searchInfo;
      document.getElementById('addStudentButton').onclick = addStudentWithGroup;
      document.getElementById('saveButton').onclick = saveTable;
      
      document.getElementById('searchInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          searchInfo();
        }
      });
      
      document.getElementById('groupInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          addStudentWithGroup();
        }
      });

      // Load saved tables from localStorage on page load
      const savedData = localStorage.getItem('savedTables');
      if (savedData) {
        savedTables = JSON.parse(savedData);
      }
    });
  </script>
</body>
</html>